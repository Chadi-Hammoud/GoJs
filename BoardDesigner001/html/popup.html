<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Component Layout</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script type="module">


  </script>

  <style>
    #form1,
    #form2 {


      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: #fff;
      border: 1px solid #ddd;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
    }

    #form2 {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: #fff;
      border: 1px solid #ddd;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;

    }

    #autoDistributePopupForm {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: #fff;
      border: 1px solid #ddd;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      display: none;
      width: 75%;
      height: 100%;
      overflow-y: auto;
      /* Allow vertical scrolling */
      /* initially hidden */
    }


    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      /* semi-transparent black overlay */
      display: none;
      /* initially hidden */
      z-index: 999;
      /* make it appear above other content */
    }
  </style>
</head>


<body>
  <div id="" class="container">
    <form id="form0">
      <div class="form-group">
        <legend>
          <fieldset>
            <div>Display Mode</div>
          </fieldset>
        </legend>
        <div class="form-check">
          <input type="checkbox" class="form-check-input">
          <label class="form-check-label">Back Mode</label>
        </div>
      </div>

      <div class="form-group">
        <legend>
          <fieldset>
            <div>Configure Slot</div>
          </fieldset>
        </legend>
        <div class="form-check">
          <input type="checkbox" class="form-check-input">
          <label class="form-check-label">Back Slot</label>
        </div>
      </div>

      <div class="form-group">
        <label>Choose slot index:</label>
        <input type="number" class="form-control" id="slotIndex" name="slotIndex">
      </div>

      <div class="form-group">
        <label>Choose index on slot:</label>
        <input type="number" class="form-control" id="indexOnSlot" name="indexOnSlot">
      </div>

      <div class="form-row">
        <div class="col">
          <label>X</label>
          <input type="number" class="form-control" id="X" name="X" step="0.00000000000000001">
        </div>
        <div class="col">
          <label>Y</label>
          <input type="number" class="form-control" id="Y" name="Y" step="0.00000000000000001">
        </div>
      </div>

      <div class="form-row">
        <div class="col">
          <label>Width</label>
          <input type="number" class="form-control" id="width" name="width" step="0.00000000000000001">
        </div>
        <div class="col">
          <label>Height</label>
          <input type="number" class="form-control" id="height" name="height" step="0.00000000000000001">


        </div>
      </div>

      <div class="form-group">
        <button type="button" class="btn btn-primary" id="auto-resize">Auto Resize</button>
        <button id="autoDist" type="button" class="btn btn-primary">Auto Distribute</button>
        <button type="submit" class="btn btn-primary">Apply</button>
      </div>

    </form>




  </div>

  <div id="size" class="container" style="display:none">
    <form name="form1" id="form1">
      <div class="form-group row">
        <label class="col-sm-2 col-form-label">Size</label>
        <div class="col-sm-10">
          <hr>
        </div>
      </div>

      <div class="form-col">
        <div class="form-group row">
          <label for="width" class="col-sm-2 col-form-label">Width</label>
          <div class="col-sm-10">
            <input type="number" class="form-control" id="width1" name="width1" step="0.00000000000000001" required>
          </div>
        </div>
        <div class="form-group row">
          <label for="height" class="col-sm-2 col-form-label">Height</label>
          <div class="col-sm-10">
            <input type="number" class="form-control" id="height1" name="height1" step="0.00000000000000001" required>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-sm-10 offset-sm-2">
          <button type="submit" class="btn btn-primary">Apply</button>
          <button id="close" class="btn btn-primary">Close</button>
        </div>
      </div>
    </form>
  </div>

  <div class="container">

    <div class="form-group">

      <button id="addSlot" class="btn btn-primary">add Slot</button>
    </div>

  </div>


  <div id="slot" class="container" style="display:none">
    <form name="form2" id="form2">


      <div class="form-col">
        <div class="form-group row">
          <label for="slotIndex" class="col-sm-2 col-form-label">choose slot index</label>
          <div class="col-sm-10">
            <input type="number" class="form-control" id="addSlotIndex" name="addSlotIndex" required>
          </div>
        </div>
        <div class="form-group row">
          <label for="indexOnSlot" class="col-sm-2 col-form-label">choose index on slot</label>
          <div class="col-sm-10">
            <input type="number" class="form-control" id="addIndexOnSlot" name="addIndexOnSlot" required>
          </div>
        </div>

        <div id="added" class="form-group row" style="display:none">
          <div style="color:red">Added</div>
        </div>
        <div class="form-group row">
          <div class="col-sm-10 offset-sm-2">
            <button type="submit" class="btn btn-primary">Ok</button>
            <button type="reset" class="btn btn-primary">cancel</button>
          </div>
        </div>
      </div>


  </div>
  <div id="autoDistributePopupForm" style="display:none">
    <form id="form3" class="mt-4">
      <!-- Margins Section -->
      <div>
        <h4>Margins</h4>
        <hr>
      </div>

      <div class="form-group">
        <label for="margin_Left">Left</label>
        <input type="number" class="form-control" id="margin_Left" name="margin_Left" value=30 required>
      </div>

      <div class="form-group">
        <label for="margin_Right">Right</label>
        <input type="number" class="form-control" id="margin_Right" name="margin_Right" value=30 required>
      </div>

      <div class="form-group">
        <label for="margin_Top">Top</label>
        <input type="number" class="form-control" id="margin_Top" name="margin_Top" value=30 required>
      </div>

      <div class="form-group">
        <label for="margin_Bottom">Bottom</label>
        <input type="number" class="form-control" id="margin_Bottom" name="margin_Bottom" value=30 required>
      </div>

      <!-- Spacing Section -->
      <div>
        <h4>Spacing</h4>
        <hr>
      </div>
      <div class="form-group">
        <label for="horizontal">Horizontal</label>
        <input type="number" class="form-control" id="horizontal" name="horizontal" value=10 required>
      </div>

      <div class="form-group">
        <label for="vertical">Vertical</label>
        <input type="number" class="form-control" id="vertical" name="vertical" value=10 required>
      </div>

      <!-- Distribution Section -->
      <div>
        <h4>Distribution</h4>
        <hr>
      </div>
      <div class="form-group">
        <label for="rowsCount">Rows</label>
        <input type="number" class="form-control" id="rowsCount" name="rowsCount" value=2 required>
      </div>

      <div class="form-group">
        <label for="startPoint">Start Point</label>
        <select class="form-control" id="startPoint" name="startPoint">
          <option value="top-left">Top-Left</option>
          <option value="top-right">Top-Right</option>
          <option value="bottom-left">Bottom-Left</option>
          <option value="bottom-right">Bottom-Right</option>
        </select>
      </div>

      <div class="form-group">
        <label for="direction">Direction</label>
        <select class="form-control" id="direction" name="direction">
          <option value="horizontal">Horizontal</option>
          <option value="vertical">Vertical</option>
        </select>
      </div>

      <!-- Buttons -->
      <button type="submit" class="btn btn-success">Apply</button>
      <button id="closeAutoDist" type="button" class="btn btn-danger close">Close</button>
    </form>
  </div>


  </form>
  </div>

  <div class="overlay" id="overlay"></div>
</body>

<script type="module">

  // import {getMyDiagram} from "../Js/data.js"
  // Inside popup.html
  document.querySelector('#form0').addEventListener('submit', function (event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    const data = Object.fromEntries(formData);
    data.formId = 'form0';
    window.opener.postMessage(data, '*');
  });

  document.querySelector('#form1').addEventListener('submit', function (event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    const data = Object.fromEntries(formData);
    data.formId = 'form1';
    window.opener.postMessage(data, '*');
  });

  document.querySelector('#form2').addEventListener('submit', function (event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    const data = Object.fromEntries(formData);
    data.formId = 'form2';
    window.opener.postMessage(data, '*');

    const form2Col = document.getElementById('added');
    form2Col.style.display = "block";
  });


  document.querySelector('#form2').addEventListener('reset', function (event) {
    event.preventDefault();
    document.getElementById("slot").style.display = "none";
    document.getElementById("addSlotIndex").value = "";
    document.getElementById("addIndexOnSlot").value = "";
    const form2Col = document.getElementById('added');
    form2Col.style.display = "none";

  });

  window.addEventListener('message', function (event) {
    // The data sent from the main window
    const data = event.data;
    console.log(data);

    // Use the data
    // For example, to populate an input with the width:
    document.getElementById('slotIndex').value = data.slotIndex;
    document.getElementById('indexOnSlot').value = data.indexOnSlot;
    document.getElementById('X').value = data.X;
    document.getElementById('Y').value = data.Y;
    document.getElementById('width').value = data.width;
    document.getElementById('height').value = data.height;

  }, false);



  function showNodeSize() {
    document.getElementById("size").style.display = "block"
  }

  function hideNodeSize() {
    document.getElementById("size").style.display = "none"
  }

  function showAddSlotFrame() {
    document.getElementById("slot").style.display = "block"
  }

  function hideAddSlotFrame() {
    document.getElementById("slot").style.display = "none"
  }

  function showAutoDist() {
    document.getElementById("autoDistributePopupForm").style.display = "block";
    document.getElementById("overlay").style.display = "block";
  }

  function hideAutoDist() {
    document.getElementById("autoDistributePopupForm").style.display = "none";
    document.getElementById("overlay").style.display = "none";
  }



  let autoResize = document.getElementById("auto-resize");
  autoResize.addEventListener("click", showNodeSize);

  let close = document.getElementById("close");
  close.addEventListener("click", hideNodeSize);

  let addSlot = document.getElementById("addSlot");
  addSlot.addEventListener("click", showAddSlotFrame)

  let autoDist = document.getElementById("autoDist");
  autoDist.addEventListener("click", showAutoDist)

  let closeAutoDist = document.getElementById("closeAutoDist");
  closeAutoDist.addEventListener("click", hideAutoDist)


  // let width;
  // let height;
  // window.addEventListener('message', function (event) {
  //   // Optional: Check the origin of the data!
  //   // if (event.origin !== "http://example.com:8080")
  //   //     return;

  //   // The data sent from the popup
  //   if (event.source.name === "AutoResizePopup") {
  //     UpdateAllNodesSize();
  //   }



  // }, false);

  // let myDiagram = getMyDiagram();

  // function UpdateAllNodesSize() {
  //   // Iterate over all nodes
  //   myDiagram.nodes.each(function (node) {
  //     // Start a transaction
  //     myDiagram.startTransaction('update size');

  //     var key = node.key;
  //     var data = myDiagram.model.findNodeDataForKey(key);

  //     myDiagram.model.setDataProperty(data, "width", width);
  //     myDiagram.model.setDataProperty(data, "height", height);
  //     node.updateTargetBindings();
  //     // Commit the transaction
  //     myDiagram.commitTransaction('update size');

  //   });


  // }


</script>

</html>